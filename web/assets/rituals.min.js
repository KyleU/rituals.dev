var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.createTemplateTagFirstArg=function(b){return b.raw=b};$jscomp.createTemplateTagFirstArgWithRaw=function(b,e){b.raw=e;return b};$jscomp.arrayIteratorImpl=function(b){var e=0;return function(){return e<b.length?{done:!1,value:b[e++]}:{done:!0}}};$jscomp.arrayIterator=function(b){return{next:$jscomp.arrayIteratorImpl(b)}};$jscomp.makeIterator=function(b){var e="undefined"!=typeof Symbol&&Symbol.iterator&&b[Symbol.iterator];return e?e.call(b):$jscomp.arrayIterator(b)};
$jscomp.arrayFromIterator=function(b){for(var e,c=[];!(e=b.next()).done;)c.push(e.value);return c};$jscomp.arrayFromIterable=function(b){return b instanceof Array?b:$jscomp.arrayFromIterator($jscomp.makeIterator(b))};$jscomp.getGlobal=function(b){b=["object"==typeof globalThis&&globalThis,b,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var e=0;e<b.length;++e){var c=b[e];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");};
$jscomp.global=$jscomp.getGlobal(this);$jscomp.checkEs6ConformanceViaProxy=function(){try{var b={},e=Object.create(new $jscomp.global.Proxy(b,{get:function(c,a,d){return c==b&&"q"==a&&d==e}}));return!0===e.q}catch(c){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;
$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,e,c){if(b==Array.prototype||b==Object.prototype)return b;b[e]=c.value;return b};$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};
$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(b,e){var c=$jscomp.propertyToPolyfillSymbol[e];if(null==c)return b[e];c=b[c];return void 0!==c?c:b[e]};$jscomp.polyfill=function(b,e,c,a){e&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(b,e,c,a):$jscomp.polyfillUnisolated(b,e,c,a))};
$jscomp.polyfillUnisolated=function(b,e,c,a){c=$jscomp.global;b=b.split(".");for(a=0;a<b.length-1;a++){var d=b[a];if(!(d in c))return;c=c[d]}b=b[b.length-1];a=c[b];e=e(a);e!=a&&null!=e&&$jscomp.defineProperty(c,b,{configurable:!0,writable:!0,value:e})};
$jscomp.polyfillIsolated=function(b,e,c,a){var d=b.split(".");b=1===d.length;a=d[0];a=!b&&a in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var f=0;f<d.length-1;f++){var g=d[f];if(!(g in a))return;a=a[g]}d=d[d.length-1];c=$jscomp.IS_SYMBOL_NATIVE&&"es6"===c?a[d]:null;e=e(c);null!=e&&(b?$jscomp.defineProperty($jscomp.polyfills,d,{configurable:!0,writable:!0,value:e}):e!==c&&($jscomp.propertyToPolyfillSymbol[d]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(d):$jscomp.POLYFILL_PREFIX+d,d=
$jscomp.propertyToPolyfillSymbol[d],$jscomp.defineProperty(a,d,{configurable:!0,writable:!0,value:e})))};$jscomp.initSymbol=function(){};
$jscomp.polyfill("Symbol",function(b){if(b)return b;var e=function(d,f){this.$jscomp$symbol$id_=d;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:f})};e.prototype.toString=function(){return this.$jscomp$symbol$id_};var c=0,a=function(d){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new e("jscomp_symbol_"+(d||"")+"_"+c++,d)};return a},"es6","es3");$jscomp.initSymbolIterator=function(){};
$jscomp.polyfill("Symbol.iterator",function(b){if(b)return b;b=Symbol("Symbol.iterator");for(var e="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),c=0;c<e.length;c++){var a=$jscomp.global[e[c]];"function"===typeof a&&"function"!=typeof a.prototype[b]&&$jscomp.defineProperty(a.prototype,b,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return b},"es6",
"es3");$jscomp.initSymbolAsyncIterator=function(){};$jscomp.iteratorPrototype=function(b){b={next:b};b[Symbol.iterator]=function(){return this};return b};$jscomp.owns=function(b,e){return Object.prototype.hasOwnProperty.call(b,e)};
$jscomp.polyfill("WeakMap",function(b){function e(){if(!b||!Object.seal)return!1;try{var l=Object.seal({}),m=Object.seal({}),n=new b([[l,2],[m,3]]);if(2!=n.get(l)||3!=n.get(m))return!1;n.delete(l);n.set(m,4);return!n.has(l)&&4==n.get(m)}catch(p){return!1}}function c(){}function a(l){var m=typeof l;return"object"===m&&null!==l||"function"===m}function d(l){if(!$jscomp.owns(l,g)){var m=new c;$jscomp.defineProperty(l,g,{value:m})}}function f(l){if(!$jscomp.ISOLATE_POLYFILLS){var m=Object[l];m&&(Object[l]=
function(n){if(n instanceof c)return n;Object.isExtensible(n)&&d(n);return m(n)})}}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(b&&$jscomp.ES6_CONFORMANCE)return b}else if(e())return b;var g="$jscomp_hidden_"+Math.random();f("freeze");f("preventExtensions");f("seal");var k=0,h=function(l){this.id_=(k+=Math.random()+1).toString();if(l){l=$jscomp.makeIterator(l);for(var m;!(m=l.next()).done;)m=m.value,this.set(m[0],m[1])}};h.prototype.set=function(l,m){if(!a(l))throw Error("Invalid WeakMap key");
d(l);if(!$jscomp.owns(l,g))throw Error("WeakMap key fail: "+l);l[g][this.id_]=m;return this};h.prototype.get=function(l){return a(l)&&$jscomp.owns(l,g)?l[g][this.id_]:void 0};h.prototype.has=function(l){return a(l)&&$jscomp.owns(l,g)&&$jscomp.owns(l[g],this.id_)};h.prototype.delete=function(l){return a(l)&&$jscomp.owns(l,g)&&$jscomp.owns(l[g],this.id_)?delete l[g][this.id_]:!1};return h},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(b){function e(){if($jscomp.ASSUME_NO_NATIVE_MAP||!b||"function"!=typeof b||!b.prototype.entries||"function"!=typeof Object.seal)return!1;try{var h=Object.seal({x:4}),l=new b($jscomp.makeIterator([[h,"s"]]));if("s"!=l.get(h)||1!=l.size||l.get({x:4})||l.set({x:4},"t")!=l||2!=l.size)return!1;var m=l.entries(),n=m.next();if(n.done||n.value[0]!=h||"s"!=n.value[1])return!1;n=m.next();return n.done||4!=n.value[0].x||"t"!=n.value[1]||!m.next().done?!1:!0}catch(p){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(b&&$jscomp.ES6_CONFORMANCE)return b}else if(e())return b;var c=new WeakMap,a=function(h){this.data_={};this.head_=g();this.size=0;if(h){h=$jscomp.makeIterator(h);for(var l;!(l=h.next()).done;)l=l.value,this.set(l[0],l[1])}};a.prototype.set=function(h,l){h=0===h?0:h;var m=d(this,h);m.list||(m.list=this.data_[m.id]=[]);m.entry?m.entry.value=l:(m.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:h,value:l},m.list.push(m.entry),
this.head_.previous.next=m.entry,this.head_.previous=m.entry,this.size++);return this};a.prototype.delete=function(h){h=d(this,h);return h.entry&&h.list?(h.list.splice(h.index,1),h.list.length||delete this.data_[h.id],h.entry.previous.next=h.entry.next,h.entry.next.previous=h.entry.previous,h.entry.head=null,this.size--,!0):!1};a.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=g();this.size=0};a.prototype.has=function(h){return!!d(this,h).entry};a.prototype.get=function(h){return(h=
d(this,h).entry)&&h.value};a.prototype.entries=function(){return f(this,function(h){return[h.key,h.value]})};a.prototype.keys=function(){return f(this,function(h){return h.key})};a.prototype.values=function(){return f(this,function(h){return h.value})};a.prototype.forEach=function(h,l){for(var m=this.entries(),n;!(n=m.next()).done;)n=n.value,h.call(l,n[1],n[0],this)};a.prototype[Symbol.iterator]=a.prototype.entries;var d=function(h,l){var m=l&&typeof l;"object"==m||"function"==m?c.has(l)?m=c.get(l):
(m=""+ ++k,c.set(l,m)):m="p_"+l;var n=h.data_[m];if(n&&$jscomp.owns(h.data_,m))for(h=0;h<n.length;h++){var p=n[h];if(l!==l&&p.key!==p.key||l===p.key)return{id:m,list:n,index:h,entry:p}}return{id:m,list:n,index:-1,entry:void 0}},f=function(h,l){var m=h.head_;return $jscomp.iteratorPrototype(function(){if(m){for(;m.head!=h.head_;)m=m.previous;for(;m.next!=m.head;)return m=m.next,{done:!1,value:l(m)};m=null}return{done:!0,value:void 0}})},g=function(){var h={};return h.previous=h.next=h.head=h},k=0;
return a},"es6","es3");$jscomp.findInternal=function(b,e,c){b instanceof String&&(b=String(b));for(var a=b.length,d=0;d<a;d++){var f=b[d];if(e.call(c,f,d,b))return{i:d,v:f}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(e,c){return $jscomp.findInternal(this,e,c).v}},"es6","es3");
$jscomp.checkStringArgs=function(b,e,c){if(null==b)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(e instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return b+""};
$jscomp.polyfill("String.prototype.endsWith",function(b){return b?b:function(e,c){var a=$jscomp.checkStringArgs(this,e,"endsWith");e+="";void 0===c&&(c=a.length);c=Math.max(0,Math.min(c|0,a.length));for(var d=e.length;0<d&&0<c;)if(a[--c]!=e[--d])return!1;return 0>=d}},"es6","es3");var rituals;
(function(b){b.onError=function(e,c){console.error(e.key+": "+c);var a=c.lastIndexOf(":");-1<a&&(c=c.substr(a+1));notify.notify(e.key+" error: "+c,!1)};b.init=function(e,c){window.onbeforeunload=function(){socket.setAppUnloading()};socket.socketConnect(services.fromKey(e),c)}})(rituals||(rituals={}));var action;
(function(b){b.loadActions=function(){socket.send({svc:services.system.key,cmd:command.client.getActions,param:null})};b.viewActions=function(e){dom.setContent("#action-list",b.renderActions(e))}})(action||(action={}));
(function(b){b.renderActions=function(e){return 0===e.length?JSX("div",null,"No actions available"):JSX("table",{class:"uk-table uk-table-divider uk-text-left"},JSX("thead",null,JSX("tr",null,JSX("th",null,"User"),JSX("th",null,"Act"),JSX("th",null,"Content"),JSX("th",null,"Note"),JSX("th",null,"Created"))),JSX("tbody",null,e.map(function(c){var a=JSON.stringify(c.content,null,2);return JSX("tr",null,JSX("td",null,member.renderTitle(member.getMember(c.userID))),JSX("td",null,c.act),JSX("td",null,
"null"===a?"":JSX("pre",null,a)),JSX("td",null,c.note),JSX("td",{class:"uk-table-shrink uk-text-nowrap"},date.toDateTimeString(new Date(c.created))))})))}})(action||(action={}));var auth;(function(b){b.allProviders=[{key:"github",title:"GitHub"},{key:"google",title:"Google"},{key:"slack",title:"Slack"},{key:"facebook",title:"Facebook"},{key:"amazon",title:"Amazon"},{key:"microsoft",title:"Microsoft"}];var e=[];b.applyAuths=function(c){e=c};b.active=function(){return e?e:[]}})(auth||(auth={}));var comment;
(function(b){function e(h,l){h&&"modal"!==h||(h=g,l||(l=k));"root"===h&&(h="");return l?f.filter(function(m){return m.targetType===h&&m.targetID==l}):f.filter(function(m){return m.targetType===h})}function c(h,l){h&&"modal"!==h||(h=g,l||(l=k));if(h){if(g=h,k=l,l=e(h,l),"root"!==h&&(h="modal"),dom.setContent("#drop-comment-"+h+" .uk-card-body",b.renderComments(l,system.cache.getProfile())),h=dom.opt("#drop-comment-"+h+" .uk-comment-list"))h.scrollTop=h.scrollHeight}else console.warn("invalid comment type ["+
h+"]")}function a(){var h=dom.els(".comment-count-container"),l=!1,m=dom.opt("#comment-count-modal");h.forEach(function(n){var p=n.dataset.commentType,q=n.dataset.commentId;if(!p)throw"invalid comment type ["+p+"] with id ["+q+"]";q=e(p,q);d(p,q,n);g===p&&m&&(d(p,q,m),l=!0)});!l&&m&&d("modal",[],m,!0)}function d(h,l,m,n){dom.setText(dom.req(".text",m),l.length.toString());"root"!==h&&"modal"!==h&&0!==h.length&&dom.setDisplay(m,0!==l.length||!0===n)}var f=[],g,k;b.applyComments=function(h){f=h};b.setActive=
function(h,l){g=h;k=l};b.show=function(h){modal.open("comment",h)};b.add=function(h){h=dom.req("#comment-add-content-"+h);var l=h.value.trim();0===l.length?notify.notify("enter some content",!0):(h.value="",socket.send({svc:services.system.key,cmd:command.client.addComment,param:{targetType:g,targetID:k,content:l}}))};b.onCommentUpdate=function(h){f.push(h);a();c()};b.load=c;b.setCounts=a;b.closeDrop=function(){"story"===g?modal.openSoon("story"):"report"===g?modal.openSoon("report"):"feedback"===
g&&modal.openSoon("feedback");g=void 0};b.remove=function(h){confirm("remove this comment?")&&socket.send({svc:services.system.key,cmd:command.client.removeComment,param:h});return!1};b.onCommentRemoved=function(h){f=f.filter(function(l){return l.id!==h});a();c()}})(comment||(comment={}));
(function(b){b.renderComments=function(e,c){return 0===e.length?JSX("p",{class:"uk-margin-bottom"},"No comments yet, why not add one?"):JSX("ul",{class:"uk-comment-list"},e.map(function(a){var d=a.userID===c.userID?JSX("div",{class:"right"},JSX("a",{class:c.linkColor+"-fg uk-margin-small-right","data-uk-icon":"close",href:"",onclick:"return comment.remove('"+a.id+"');",title:"remove your comment"})):JSX("span",null);return JSX("li",null,JSX("article",{class:"uk-comment uk-visible-toggle uk-transition-toggle",
tabindex:"-1"},member.renderHeader(member.getMember(a.userID),a.created,d),JSX("div",{class:"uk-comment-body"},JSX("div",{dangerouslySetInnerHTML:{__html:a.html}})),JSX("hr",null)))}))};b.renderCount=function(e,c){var a=system.cache.getProfile();return JSX("div",{class:"comment-count-container uk-margin-small-left left hidden","data-comment-type":e,"data-comment-id":c},JSX("a",{class:a.linkColor+"-fg",title:"view comments"},JSX("div",{class:"comment-count"},JSX("span",{class:"uk-icon","data-uk-icon":"comment"}),
JSX("span",{class:"text"}))))}})(comment||(comment={}));var contents;(function(b){b.onContentDisplay=function(e,c,a,d){dom.setDisplay("#modal-"+e+" .content-edit",c);dom.setDisplay("#modal-"+e+" .buttons-edit",c);var f=dom.setDisplay("#modal-"+e+" .content-view",!c);dom.setHTML(f,c?"":d);dom.setDisplay("#modal-"+e+" .buttons-view",!c);e=dom.req("#"+e+"-edit-content");dom.setValue(e,c?a:"");c&&dom.wireTextarea(e)}})(contents||(contents={}));
(function(b){function e(c,a){return a.map(function(d){return{svc:c,session:d}})}b.renderContents=function(c,a,d){d=e(a,d);d.sort(function(f,g){return f.session.created>g.session.created?-1:1});return 0===d.length?JSX("div",null,"No "+a.plural+" in this "+c.key):JSX("table",{class:"uk-table uk-table-divider uk-text-left"},JSX("tbody",null,d.map(function(f){var g=f.svc;f=f.session;var k=system.cache.getProfile();return JSX("tr",null,JSX("td",null,JSX("a",{class:k.linkColor+"-fg",href:"/"+g.key+"/"+
f.slug},f.title)),JSX("td",{class:"uk-table-shrink uk-text-nowrap"},date.toDateTimeString(new Date(f.created))))})))}})(contents||(contents={}));var dom;
(function(b){function e(f,g){var k=[];(g?g.querySelectorAll(f):document.querySelectorAll(f)).forEach(function(h){k.push(h)});return k}function c(f,g){g=e(f,g);switch(g.length){case 0:break;case 1:return g[0];default:console.warn("found ["+g.length+"] elements with selector ["+f+"], wanted zero or one")}}function a(f,g){(g=c(f,g))||console.warn("no element found for selector ["+f+"]");return g}function d(f,g){"string"===typeof f&&(f=a(f));f.innerHTML=g;return f}b.initDom=function(f,g){try{style.themeLinks(g),
style.setTheme(f)}catch(k){console.warn("error setting style",k)}try{modal.wire()}catch(k){console.warn("error wiring modals",k)}try{drop.wire()}catch(k){console.warn("error wiring drops",k)}try{tags.wire()}catch(k){console.warn("error wiring tag editors",k)}};b.els=e;b.opt=c;b.req=a;b.setHTML=d;b.setDisplay=function(f,g,k){k=void 0===k?"block":k;"string"===typeof f&&(f=a(f));f.style.display=g?k:"none";return f};b.setContent=function(f,g){"string"===typeof f&&(f=a(f));b.clear(f);f.appendChild(g);
return f};b.setText=function(f,g){"string"===typeof f&&(f=a(f));f.innerText=g;return f};b.clear=function(f){return d(f,"")}})(dom||(dom={}));
(function(b){b.setValue=function(e,c){"string"===typeof e&&(e=b.req(e));e.value=c;return e};b.wireTextarea=function(e){function c(){e.style.height="auto";e.style.height=(64>e.scrollHeight?64:e.scrollHeight+6)+"px"}function a(){window.setTimeout(c,0)}e.dataset.autoresize||(e.dataset.autoresize="true",e.addEventListener("change",c,!1),e.addEventListener("cut",a,!1),e.addEventListener("paste",a,!1),e.addEventListener("drop",a,!1),e.addEventListener("keydown",a,!1),e.focus(),e.select());c()};b.setOptions=
function(e,c){"string"===typeof e&&(e=b.req(e));b.clear(e);c.forEach(function(a){var d=document.createElement("option");d.value=a;b.setText(d,a);e.appendChild(d)})};b.setSelectOption=function(e,c){"string"===typeof e&&(e=b.req(e));for(var a=0;a<e.children.length;a++){var d=e.children.item(a);d.selected=d.value===c}};b.insertAtCaret=function(e,c){if(e.selectionStart||0===e.selectionStart){var a=e.selectionStart,d=e.selectionEnd;e.value=e.value.substring(0,a)+c+e.value.substring(d,e.value.length);e.selectionStart=
a+c.length;e.selectionEnd=a+c.length}else e.value+=c}})(dom||(dom={}));
function JSX(b,e){var c=document.createElement(b),a;for(a in e)if(a&&e.hasOwnProperty(a)){var d=e[a];"dangerouslySetInnerHTML"===a?dom.setHTML(c,d.__html):!0===d?c.setAttribute(a,a):!1!==d&&null!==d&&void 0!==d&&c.setAttribute(a,d.toString())}for(a=2;a<arguments.length;a++)if(d=arguments[a],Array.isArray(d))d.forEach(function(f){c.appendChild(f)});else{if(void 0===d||null===d)throw"child for tag ["+b+"] is "+d;d.nodeType||(d=document.createTextNode(d.toString()));c.appendChild(d)}return c}var style;
(function(b){function e(a){c(a);var d=dom.els(".uk-card");switch(a){case "auto":a="light";window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&(a="dark");e(a);fetch("/profile/theme/"+a).then(function(f){return f.text()}).then(function(){});break;case "light":document.documentElement.classList.remove("uk-light");document.body.classList.remove("uk-light");document.documentElement.classList.add("uk-dark");document.body.classList.add("uk-dark");d.forEach(function(f){f.classList.add("uk-card-default");
f.classList.remove("uk-card-secondary")});break;case "dark":document.documentElement.classList.add("uk-light");document.body.classList.add("uk-light");document.documentElement.classList.remove("uk-dark");document.body.classList.remove("uk-dark");d.forEach(function(f){f.classList.remove("uk-card-default");f.classList.add("uk-card-secondary")});break;default:console.warn("invalid theme")}}function c(a){if("undefined"===typeof EmojiButton)dom.els(".picker-toggle").forEach(function(f){return dom.setDisplay(f,
!1)});else{var d={position:"bottom-end",theme:a,zIndex:1021};dom.els(".textarea-emoji").forEach(function(f){var g=dom.req(".picker-toggle",f);g.addEventListener("click",function(){var k=dom.req(".uk-textarea",f),h=new EmojiButton(d);h.on("emoji",function(l){drop.onEmojiPicked();dom.insertAtCaret(k,l)});h.togglePicker(g)},!1)})}}b.setTheme=e;b.themeLinks=function(a){dom.els(".theme").forEach(function(d){d.classList.add(a+"-fg")})}})(style||(style={}));var estimate;
(function(b){function e(g){b.cache.detail=g;var k=g.choices.join(", ");dom.setValue("#model-choices-input",k);dom.setContent("#session-view-section .choices",tags.renderTagsView(g.choices));story.viewActiveStory();session.setDetail(g)}function c(g){var k=d(g.id);k.push(g);k.sort(function(h){return h.idx});g.id===b.cache.activeStory&&dom.setText("#story-title",g.title);story.setStories(k)}function a(g){var k=d(g);story.setStories(k);g===b.cache.activeStory&&modal.hide("story");notify.notify("story has been deleted",
!0)}function d(g){return b.cache.stories.filter(function(k){return k.id!==g})}var f=function(){this.stories=[];this.votes=[]};f.prototype.activeVotes=function(){var g=this;return this.activeStory?this.votes.filter(function(k){return k.storyID===g.activeStory}):[]};b.cache=new f;b.onEstimateMessage=function(g,k){switch(g){case command.server.error:rituals.onError(services.estimate,k);break;case command.server.sessionJoined:session.onSessionJoin(k);e(k.session);story.setStories(k.stories);vote.setVotes(k.votes);
session.showWelcomeMessage(k.members.length);break;case command.server.sessionUpdate:e(k);break;case command.server.sessionRemove:system.onSessionRemove(services.estimate);break;case command.server.permissionsUpdate:system.setPermissions(k);break;case command.server.teamUpdate:b.cache.detail&&(b.cache.detail.teamID=null===k||void 0===k?void 0:k.id);session.setTeam(k);break;case command.server.sprintUpdate:b.cache.detail&&(b.cache.detail.sprintID=null===k||void 0===k?void 0:k.id);session.setSprint(k);
break;case command.server.storyUpdate:c(k);break;case command.server.storyRemove:a(k);break;case command.server.storyStatusChange:story.onStoryStatusChange(k);break;case command.server.voteUpdate:vote.onVoteUpdate(k);break;default:console.warn("unhandled command ["+g+"] for estimate")}};b.onSubmitEstimateSession=function(){var g=dom.req("#model-title-input").value,k=dom.req("#model-choices-input").value,h=dom.req("#model-team-select select").value,l=dom.req("#model-sprint-select select").value,m=
permission.readPermissions();socket.send({svc:services.estimate.key,cmd:command.client.updateSession,param:{title:g,choices:k,teamID:h,sprintID:l,permissions:m}})};b.onStoryUpdate=c;b.onStoryRemove=a})(estimate||(estimate={}));var drop;
(function(b){function e(f){if(f.target){var g=f.target;f=g.dataset.key||"";g=g.dataset.t||"";var k=events.getOpenEvent(f);k?k(g):console.warn("no drop open handler registered for ["+f+"]")}}function c(f){if(f.target){var g=f.target;g.classList.contains("uk-open")&&(f=g.dataset.t||"",(g=events.getCloseEvent(g.dataset.key||""))&&g(f))}}function a(f){d&&f.preventDefault()}b.wire=function(){dom.els(".drop").forEach(function(f){f.addEventListener("show",e);f.addEventListener("beforehide",a);f.addEventListener("hide",
c)});events.register("comment",comment.load,comment.closeDrop);events.register("export")};var d=!1;b.onEmojiPicked=function(){d=!0;setTimeout(function(){return d=!1},200)}})(drop||(drop={}));var events;(function(b){var e=new Map,c=new Map;b.register=function(a,d,f){d||(d=function(){});e.set(a,d);f&&c.set(a,f)};b.getOpenEvent=function(a){return e.get(a)};b.getCloseEvent=function(a){return c.get(a)}})(events||(events={}));var modal;
(function(b){function e(f,g){d=g;notify.modal("#modal-"+f).show();return!1}function c(f){if(f.target&&(f=f.target,0===f.id.indexOf("modal"))){f=f.id.substr(6);var g=events.getOpenEvent(f);g?g(d):console.warn("no modal open handler registered for ["+f+"]");d=void 0}}function a(f){f.target&&(f=f.target,f.classList.contains("uk-open")&&(f=f.id.substr(6),(f=events.getCloseEvent(f))&&f(d),d=void 0))}var d;b.wire=function(){dom.els(".modal").forEach(function(f){f.addEventListener("show",c);f.addEventListener("hide",
a)});events.register("welcome");events.register("session",session.onModalOpen);events.register("action",action.loadActions);events.register("self",member.viewSelf);events.register("invitation",member.loadQR);events.register("member",member.viewActiveMember);events.register("add-story",story.viewAddStory);events.register("story",story.viewActiveStory);events.register("add-report",report.viewAddReport);events.register("report",report.viewReport);events.register("add-feedback",feedback.viewAddFeedback);
events.register("feedback",feedback.viewFeedback)};b.open=e;b.openSoon=function(f){setTimeout(function(){return e(f)},0)};b.hide=function(f){f=notify.modal("#modal-"+f);f.$el.classList.contains("uk-open")&&f.hide()}})(modal||(modal={}));var tags;
(function(b){function e(d){var f=dom.req(".value",d),g=dom.req(".editor",d);dom.setDisplay(f,!1);dom.setDisplay(g,!0);var k=b.renderInput(f.innerText);k.onblur=function(){f.innerText=k.value;dom.setDisplay(f,!0);dom.setDisplay(g,!1);a(d.parentElement)};k.onkeypress=function(h){return"Enter"===h.key?(k.blur(),!1):!0};dom.setContent(g,k);k.focus()}function c(d){d.target?a(d.target):console.warn("no event target")}function a(d){var f=d.dataset.key||"",g=events.getOpenEvent(f);g?g():console.warn("no tag open handler registered for ["+
f+"]");d=dom.els(".item",d).map(function(k){return k.innerText});dom.setValue("#model-"+f+"-input",d.join(","))}b.wire=function(){dom.els(".tag-editor").forEach(function(d){d.addEventListener("moved",c);d.addEventListener("added",c);d.addEventListener("removed",c)});events.register("choices");events.register("categories")};b.removeTag=function(d){d=d.parentElement;var f=d.parentElement;d.remove();a(f)};b.addTag=function(d){if(d=d.parentElement){var f=b.renderItem();d.insertBefore(f,dom.req(".add-item",
d));e(f)}};b.editTag=e})(tags||(tags={}));
(function(b){b.renderInput=function(e){return JSX("input",{type:"text",class:"uk-input",value:e})};b.renderItem=function(){return JSX("span",{class:"item"},JSX("span",{class:"value",onclick:"tags.editTag(this.parentElement);"}),JSX("span",{class:"editor"}),JSX("span",{class:"close","data-uk-icon":"icon: close; ratio: 0.6;",onclick:"tags.removeTag(this);"}))};b.renderTagsView=function(e){return JSX("div",{class:"tag-view"},e.map(function(c){return JSX("span",{class:"item"},c)}),JSX("div",{class:"clear"}))}})(tags||
(tags={}));var feedback;
(function(b){function e(){if(retro.cache.activeFeedback){var d=retro.cache.feedback.filter(function(f){return f.id===retro.cache.activeFeedback}).shift();d||console.warn("cannot load active Feedback ["+retro.cache.activeFeedback+"]");return d}}function c(d){return retro.cache.feedback.filter(function(f){return f.id!==d})}function a(d,f){feedback.setFeedback(d);f===retro.cache.activeFeedback&&modal.hide("feedback")}b.setFeedback=function(d){retro.cache.feedback=d;dom.setContent("#feedback-detail",b.renderFeedbackArray(d));
comment.setCounts();modal.hide("add-feedback")};b.onSubmitFeedback=function(){var d=dom.req("#feedback-category").value,f=dom.req("#feedback-content").value;socket.send({svc:services.retro.key,cmd:command.client.addFeedback,param:{category:d,content:f}});return!1};b.onEditFeedback=function(){var d=retro.cache.activeFeedback,f=dom.req("#feedback-edit-category").value,g=dom.req("#feedback-edit-content").value;socket.send({svc:services.retro.key,cmd:command.client.updateFeedback,param:{id:d,category:f,
content:g}});return!1};b.onRemoveFeedback=function(){var d=retro.cache.activeFeedback;d&&notify.confirm("Delete this feedback?",function(){socket.send({svc:services.retro.key,cmd:command.client.removeFeedback,param:d});modal.hide("feedback")});return!1};b.getActiveFeedback=e;b.viewActiveFeedback=function(d){var f,g=system.cache.getProfile();d&&(retro.cache.activeFeedback=d);(d=e())?(g=d.userID===g.userID,dom.setText("#feedback-title",d.category+" / "+(null===(f=member.getMember(d.userID))||void 0===
f?void 0:f.name)),dom.setSelectOption("#feedback-edit-category",g?d.category:void 0),contents.onContentDisplay("feedback",g,d.content,d.html),comment.setActive("feedback",d.id),comment.setCounts()):console.warn("no active feedback")};b.onFeedbackUpdate=function(d){var f=c(d.id);f.push(d);a(f,d.id)};b.onFeedbackRemoved=function(d){var f=c(d);a(f,d);notify.notify("feedback has been deleted",!0)};b.getFeedbackCategories=function(d,f){var g=f.map(function(h){var l=d.filter(function(m){return m.category===
h}).sort(function(m,n){return m.created>n.created?-1:1});return{category:h,feedback:l}}),k=d.filter(function(h){return!f.find(function(l){return l===h.category})});0<k.length&&g.push({category:"unknown",feedback:k});return g};b.viewAddFeedback=function(d){dom.setSelectOption("#feedback-category",d);var f=dom.setValue("#feedback-content","");dom.wireTextarea(f);setTimeout(function(){return f.focus()},250)};b.viewFeedback=function(d){feedback.viewActiveFeedback(d);var f=dom.req("#feedback-edit-content");
setTimeout(function(){dom.wireTextarea(f);f.focus()},250)}})(feedback||(feedback={}));
(function(b){b.renderFeedbackArray=function(e){var c;if(0===e.length)return JSX("div",null,JSX("button",{class:"uk-button uk-button-default",onclick:"modal.open('add-feedback');",type:"button"},"Add Feedback"));e=b.getFeedbackCategories(e,(null===(c=retro.cache.detail)||void 0===c?void 0:c.categories)||[]);var a=system.cache.getProfile();return JSX("div",{class:"uk-grid-small uk-grid-match uk-child-width-expand@m uk-grid-divider","data-uk-grid":!0},e.map(function(d){return JSX("div",{class:"feedback-list uk-transition-toggle"},
JSX("div",{class:"feedback-category-header"},JSX("span",{class:"right"},JSX("a",{class:a.linkColor+"-fg uk-icon-button uk-transition-fade","data-uk-icon":"plus",onclick:"modal.open('add-feedback', '"+d.category+"');",title:"add feedback"})),JSX("span",{class:"feedback-category-title",onclick:"modal.open('add-feedback', '"+d.category+"');"},d.category)),JSX("div",null,d.feedback.map(function(f){var g=system.cache.getProfile();g=JSX("div",{id:"feedback-"+f.id,class:"feedback-detail section",onclick:"modal.open('feedback', '"+
f.id+"');"},JSX("div",{class:"feedback-comments right"},comment.renderCount("feedback",f.id)),JSX("div",{class:"left"},JSX("a",{class:g.linkColor+"-fg section-link"},member.renderTitle(member.getMember(f.userID)))),JSX("div",{class:"clear"}),JSX("div",{class:"feedback-content"},"loading..."));0<f.html.length&&(dom.setHTML(dom.req(".feedback-content",g),f.html).style.display="block");return JSX("div",null,g)})))}))}})(feedback||(feedback={}));var member;
(function(b){b.memberUpdateDom=function(e){if(e)switch(system.cache.currentService){case services.estimate:estimate.cache.activeStory&&vote.viewVotes();break;case services.standup:dom.setContent("#report-detail",report.renderReports(standup.cache.reports));standup.cache.activeReport&&report.viewActiveReport();break;case services.retro:dom.setContent("#feedback-detail",feedback.renderFeedbackArray(retro.cache.feedback)),retro.cache.activeFeedback&&feedback.viewActiveFeedback()}};b.activeMemberDom=
function(e){var c=b.selfCanEdit();dom.setDisplay("#modal-member .owner-form",c);dom.setDisplay("#modal-member .member-form",!c);dom.setDisplay("#modal-member .owner-actions",c);dom.setDisplay("#modal-member .member-actions",!c);dom.setSelectOption("#member-modal-role-select",e.role);dom.setText("#member-modal-name",e.name);dom.setText("#member-modal-role",e.role)}})(member||(member={}));
(function(b){function e(){b.updateSelf(a.filter(b.isSelf).shift());var f=a.filter(function(g){return!b.isSelf(g)});dom.setContent("#member-detail",b.renderMembers(f));0<f.length&&modal.hide("welcome");b.renderOnline()}function c(){if(d){var f=a.filter(function(g){return g.userID===d}).shift();f||console.warn("cannot load active member ["+d+"]");return f}console.warn("no active member")}var a=[],d;b.getMember=function(f){return a.filter(function(g){return g.userID===f}).shift()};b.getMembers=function(){return a};
b.setMembers=e;b.onMemberUpdate=function(f){b.isSelf(f)?modal.hide("self"):modal.hide("member");var g=a,k=g.filter(function(h){return h.userID===f.userID}).shift();k=(null===k||void 0===k?void 0:k.name)!==f.name;g=g.filter(function(h){return h.userID!==f.userID});g.length===a.length&&notify.notify(f.name+" has joined",!0);g.push(f);g.sort(function(h,l){return h.name>l.name?1:-1});a=g;e();b.memberUpdateDom(k)};b.onMemberRemove=function(f){var g;f===system.cache.getProfile().userID?(notify.notify("you have left this "+
(null===(g=system.cache.currentService)||void 0===g?void 0:g.key),!0),document.location.href="/"):(modal.hide("member"),g=a.filter(function(k){return k.userID!==f}),g.sort(function(k,h){return k.name>h.name?1:-1}),a=g,e())};b.viewActiveMember=function(f){f&&(d=f);(f=c())&&b.activeMemberDom(f)};b.removeMember=function(f){(f=void 0===f?d:f)||console.warn("cannot load active member ["+d+"]");"self"===f&&(f=system.cache.getProfile().userID);var g=system.cache.currentService;confirm("Are you sure you wish to leave this "+
g.key+"?")&&socket.send({svc:g.key,cmd:command.client.removeMember,param:f})};b.saveRole=function(){var f=c();if(f){var g=f.role,k=dom.req("#member-modal-role-select").value;g===k?modal.hide("member"):socket.send({svc:system.cache.currentService.key,cmd:command.client.updateMember,param:{id:f.userID,role:k}})}else console.warn("no active member")};b.applyMembers=function(f){a=f};b.loadQR=function(){var f=dom.req("#qrcode");f.src=f.dataset.src}})(member||(member={}));
(function(b){function e(c){return c?c.picture&&0<c.picture.length&&"none"!=c.picture?JSX("div",null,JSX("div",{class:"profile-image"},JSX("img",{class:"uk-border-circle",src:c.picture,alt:c.name})),JSX("div",{class:"left"},c.name),JSX("div",{class:"clear"})):JSX("div",null,JSX("div",{class:"profile-image"},JSX("span",{class:"profile-icon","data-uk-icon":"user"})),JSX("div",{class:"left"},c.name)):JSX("span",null,"{former member}")}b.renderMembers=function(c){return 0===c.length?JSX("div",null,JSX("button",
{class:"uk-button uk-button-default",onclick:"modal.open('invitation');",type:"button"},"Invite Members")):JSX("ul",{class:"uk-list uk-list-divider"},c.map(function(a){var d={id:"member-"+a.userID},f=system.cache.getProfile();a=JSX("div",{class:"section",onclick:"modal.open('member', '"+a.userID+"');"},JSX("div",{title:"user is offline",class:"right uk-article-meta online-indicator"},"offline"),JSX("div",{class:f.linkColor+"-fg section-link"},e(a)));return JSX("li",d,a)}))};b.renderTitle=e;b.renderHeader=
function(c,a,d){return JSX("header",{class:"uk-comment-header uk-position-relative"},d?d:JSX("span",null),JSX("div",{class:"uk-grid-collapse uk-flex-middle","uk-grid":!0},JSX("div",{class:"uk-width-auto"},c&&c.picture&&0<c.picture.length?JSX("div",null,JSX("div",{class:"profile-image"},JSX("img",{class:"uk-border-circle",src:c.picture,alt:c.name}))):JSX("div",null,JSX("div",{class:"profile-image"},JSX("span",{class:"profile-icon","data-uk-icon":"user"})))),JSX("div",{class:"uk-width-expand"},JSX("h4",
{class:"uk-comment-title uk-margin-remove"},null===c||void 0===c?void 0:c.name),JSX("p",{class:"uk-comment-meta uk-margin-remove-top"},date.toDateTimeString(new Date(a))))))};b.viewSelf=function(){var c=dom.setValue("#self-name-input",dom.req("#member-self .member-name").innerText);setTimeout(function(){return c.focus()},250)};b.setPicture=function(c){return c&&0<c.length&&"none"!=c?JSX("div",{class:"model-icon profile-image"},JSX("img",{class:"uk-border-circle",src:c,alt:"your picture"})):JSX("span",
{class:"model-icon h3-icon",onclick:"modal.open('self');","data-uk-icon":"icon: user;"})}})(member||(member={}));
(function(b){function e(){b.getMembers().forEach(function(a){var d=dom.opt("#member-"+a.userID+" .online-indicator");d&&(c.find(function(f){return f===a.userID})?d.classList.remove("offline"):d.classList.add("offline"))})}var c=[];b.onOnlineUpdate=function(a){a.connected?c.find(function(d){return d===a.userID})||c.push(a.userID):c=c.filter(function(d){return d!==a.userID});e()};b.applyOnline=function(a){c=a};b.renderOnline=e})(member||(member={}));
(function(b){var e;b.isSelf=function(c){return c.userID===system.cache.getProfile().userID};b.selfCanEdit=function(){return void 0!==e&&"owner"==e.role};b.updateSelf=function(c){c&&(e=c,dom.setContent("#self-picture",b.setPicture(c.picture)),dom.setText("#member-self .member-name",c.name),dom.setValue("#self-name-input",c.name),dom.setText("#member-self .member-role",c.role),c="owner"==c.role,dom.setDisplay("#history-container",c),dom.setDisplay("#session-edit-section",c),dom.setDisplay("#session-view-section",
!c))};b.onSubmitSelf=function(){var c=dom.req("#self-name-input").value,a=dom.req("#self-name-choice-global").checked?"global":"local",d=dom.req("#self-picture-input").value;socket.send({svc:services.system.key,cmd:command.client.updateProfile,param:{name:c,choice:a,picture:d}})}})(member||(member={}));var command;
(function(b){b.client={ping:"ping",connect:"connect",getActions:"get-actions",getTeams:"get-teams",getSprints:"get-sprints",updateSession:"update-session",addComment:"add-comment",updateComment:"update-comment",removeComment:"remove-comment",updateProfile:"update-profile",updateMember:"update-member",removeMember:"remove-member",addStory:"add-story",updateStory:"update-story",removeStory:"remove-story",setStoryStatus:"set-story-status",submitVote:"submit-vote",addReport:"add-report",updateReport:"update-report",
removeReport:"remove-report",addFeedback:"add-feedback",updateFeedback:"update-feedback",removeFeedback:"remove-feedback"};b.server={error:"error",pong:"pong",sessionJoined:"session-joined",sessionUpdate:"session-update",sessionRemove:"session-remove",commentUpdate:"comment-update",commentRemove:"comment-remove",permissionsUpdate:"permissions-update",teamUpdate:"team-update",sprintUpdate:"sprint-update",contentUpdate:"content-update",actions:"actions",teams:"teams",sprints:"sprints",memberUpdate:"member-update",
memberRemove:"member-remove",onlineUpdate:"online-update",storyUpdate:"story-update",storyRemove:"story-remove",storyStatusChange:"story-status-change",voteUpdate:"vote-update",reportUpdate:"report-update",reportRemove:"report-remove",feedbackUpdate:"feedback-update",feedbackRemove:"feedback-remove"}})(command||(command={}));var services;
(function(b){b.system={key:"system",title:"System",plural:"systems",icon:"close"};b.team={key:"team",title:"Team",plural:"teams",icon:"users"};b.sprint={key:"sprint",title:"Sprint",plural:"sprints",icon:"git-fork"};b.estimate={key:"estimate",title:"Estimate Session",plural:"estimates",icon:"settings"};b.standup={key:"standup",title:"Daily Standup",plural:"standups",icon:"future"};b.retro={key:"retro",title:"Retrospective",plural:"retros",icon:"history"};var e=[b.system,b.team,b.sprint,b.estimate,
b.standup,b.retro];b.fromKey=function(c){var a=e.find(function(d){return d.key===c});if(!a)throw"invalid service ["+c+"]";return a}})(services||(services={}));var permission;
(function(b){function e(a){var d=dom.opt("#model-"+a+"-select select");if(d){var f=collection.findGroup(b.permissions,a),g=dom.opt("#perm-"+a+"-section");g&&(dom.req("#perm-"+a+"-checkbox").checked=0<f.length,dom.setDisplay(g,0!==d.value.length));collection.findGroup(b.permissions,a)}}function c(a){var d=dom.opt("#perm-"+a+"-checkbox");if(!d||!d.checked)return[];d=dom.els(".perm-"+a+"-email").filter(function(f){return f.checked}).map(function(f){return f.value}).join(",");return[{k:a,v:d,access:"member"}]}
b.permissions=[];b.applyPermissions=function(a){a=collection.groupBy(a,function(d){return d.k}).groups;b.permissions=a};b.setPerms=function(){var a=null===b.permissions||0===b.permissions.length;dom.setDisplay("#public-link-container",a);dom.setDisplay("#private-link-container",!a);b.updateView();["team","sprint"].forEach(e);auth.allProviders.forEach(b.setProviderPerms)};b.setModelPerms=e;b.readPermissions=function(){var a=[];a.push.apply(a,$jscomp.arrayFromIterable(c("team")));a.push.apply(a,$jscomp.arrayFromIterable(c("sprint")));
a.push.apply(a,$jscomp.arrayFromIterable(c("github")));a.push.apply(a,$jscomp.arrayFromIterable(c("google")));a.push.apply(a,$jscomp.arrayFromIterable(c("slack")));a.push.apply(a,$jscomp.arrayFromIterable(c("facebook")));a.push.apply(a,$jscomp.arrayFromIterable(c("amazon")));a.push.apply(a,$jscomp.arrayFromIterable(c("microsoft")));return a}})(permission||(permission={}));
(function(b){function e(c){switch(c.key){case services.team.key:return JSX("li",null,"Must be a member of this session's team");case services.sprint.key:return JSX("li",null,"Must be a member of this session's sprint");default:var a=collection.flatten(c.members.map(function(d){return d.k.split(",").map(function(f){return f.trim()}).filter(function(f){return 0<f.length})}));return 0===a.length?JSX("li",null,"Must sign in with ",c.key):JSX("li",null,"Must sign in with ",c.key," using an email address from ",
a.join(" or "))}}b.renderEmails=function(c,a){var d="uk-checkbox uk-margin-small-right perm-"+c+"-email",f="permission.onChanged('email', '"+c+"', this.checked)";return JSX("ul",null,a.map(function(g){return JSX("li",null,JSX("label",null,g.matched?JSX("input",{class:d,type:"checkbox",value:g.domain,checked:"checked",onchange:f}):JSX("input",{class:d,type:"checkbox",value:g.domain,onchange:f}),"Using email address ",g.domain))}))};b.renderView=function(c){return 0===c.length?JSX("div",null,"public"):
JSX("ul",null,c.map(function(a){return e(a)}))}})(permission||(permission={}));
(function(b){function e(c,a){dom.els(".perm-"+c+"-email").forEach(function(d){d.disabled=!a;a||(d.checked=!1)})}b.setProviderPerms=function(c){var a=collection.findGroup(b.permissions,c.key),d=auth.active().filter(function(k){return k.provider===c.key});if(dom.opt("#perm-"+c.key+"-section")){dom.req("#perm-"+c.key+"-checkbox").checked=0<a.length;var f=dom.req("#perm-"+c.key+"-email-container"),g=collection.flatten(a.map(function(k){return k.v.split(",").filter(function(h){return 0<h.length})})).map(function(k){return{matched:!0,
domain:k}});a=d.filter(function(k){return 0===g.filter(function(h){return k.email.endsWith(h.domain)}).length}).map(function(k){k=k.email;var h=k.lastIndexOf("@");k=-1===h?k:k.substr(h);return{matched:!1,domain:k}});g.push.apply(g,$jscomp.arrayFromIterable(a));g.sort();dom.setDisplay(f,0<g.length);dom.setContent(f,0===g.length?document.createElement("span"):b.renderEmails(c.key,g))}};b.onChanged=function(c,a,d){switch(c){case "email":(c=dom.opt("#perm-"+a+"-checkbox"))&&d&&!c.checked&&(c.checked=
!0);break;case "provider":return e(a,d)}}})(permission||(permission={}));(function(b){b.updateView=function(){var e=dom.req("#session-view-section .perms");dom.clear(e);e.appendChild(b.renderView(b.permissions))}})(permission||(permission={}));var report;
(function(b){function e(){if(standup.cache.activeReport){var c=standup.cache.reports.filter(function(a){return a.id===standup.cache.activeReport}).shift();c||console.warn("cannot load active report ["+standup.cache.activeReport+"]");return c}console.warn("no active report")}b.onSubmitReport=function(){var c=dom.req("#report-date").value,a=dom.req("#report-content").value;socket.send({svc:services.standup.key,cmd:command.client.addReport,param:{d:c,content:a}});return!1};b.onEditReport=function(){var c=
dom.req("#report-edit-date").value,a=dom.req("#report-edit-content").value;socket.send({svc:services.standup.key,cmd:command.client.updateReport,param:{id:standup.cache.activeReport,d:c,content:a}});return!1};b.onRemoveReport=function(){var c=standup.cache.activeReport;c&&notify.confirm("Delete this report?",function(){socket.send({svc:services.standup.key,cmd:command.client.removeReport,param:c});modal.hide("report")});return!1};b.viewActiveReport=function(c){var a,d=system.cache.getProfile();c&&
(standup.cache.activeReport=c);(c=e())?(dom.setText("#report-title",date.toDateString(date.dateFromYMD(c.d))+" - "+(null===(a=member.getMember(c.userID))||void 0===a?void 0:a.name)),a=c.userID===d.userID,dom.setValue(dom.req("#report-edit-date"),a?c.d:""),contents.onContentDisplay("report",a,c.content,c.html),comment.setActive("report",c.id),comment.setCounts()):console.warn("no active report")};b.setReports=function(c){standup.cache.reports=c;dom.setContent("#report-detail",b.renderReports(c));comment.setCounts();
modal.hide("add-report")};b.getReportDates=function(c){return c.map(function(a){return a.d}).filter(function(a,d,f){return f.indexOf(a)===d}).sort().reverse().map(function(a){var d=c.filter(function(f){return f.d===a}).sort(function(f,g){return f.created>g.created?-1:1});return{d:a,reports:d}})};b.viewAddReport=function(){dom.setValue("#report-date",date.dateToYMD(new Date));var c=dom.setValue("#report-content","");dom.wireTextarea(c);setTimeout(function(){return c.focus()},250)};b.viewReport=function(c){report.viewActiveReport(c);
var a=dom.req("#report-edit-content");setTimeout(function(){dom.wireTextarea(a);a.focus()},250)}})(report||(report={}));
(function(b){b.renderReports=function(e){if(0===e.length)return JSX("div",null,JSX("button",{class:"uk-button uk-button-default",onclick:"modal.open('add-report');",type:"button"},"Add Report"));e=b.getReportDates(e);return JSX("ul",{class:"uk-list"},e.map(function(c){return JSX("li",{id:"report-date-"+c.d},JSX("h5",null,JSX("div",{class:"right uk-article-meta"},date.dow(date.dateFromYMD(c.d).getDay())),date.toDateString(date.dateFromYMD(c.d))),JSX("ul",null,c.reports.map(function(a){var d=system.cache.getProfile();
d=JSX("div",{id:"report-"+a.id,class:"report-detail section",onclick:"modal.open('report', '"+a.id+"');"},JSX("div",{class:"report-comments right"},comment.renderCount("report",a.id)),JSX("div",{class:"left"},JSX("a",{class:d.linkColor+"-fg section-link"},member.renderTitle(member.getMember(a.userID)))),JSX("div",{class:"clear"}),JSX("div",{class:"report-content"},"loading..."));0<a.html.length&&(dom.setHTML(dom.req(".report-content",d),a.html).style.display="block");return JSX("li",null,d)})))}))}})(report||
(report={}));var retro;
(function(b){function e(c){b.cache.detail=c;var a=c.categories.join(", ");dom.setValue("#model-categories-input",a);dom.setContent("#session-view-section .categories",tags.renderTagsView(c.categories));dom.setOptions("#feedback-category",c.categories);dom.setOptions("#feedback-edit-category",c.categories);feedback.setFeedback(b.cache.feedback);session.setDetail(c)}b.cache=new function(){this.feedback=[]};b.onRetroMessage=function(c,a){switch(c){case command.server.error:rituals.onError(services.retro,a);
break;case command.server.sessionJoined:session.onSessionJoin(a);e(a.session);feedback.setFeedback(a.feedback);session.showWelcomeMessage(a.members.length);break;case command.server.sessionUpdate:e(a);break;case command.server.sessionRemove:system.onSessionRemove(services.retro);break;case command.server.permissionsUpdate:system.setPermissions(a);break;case command.server.teamUpdate:b.cache.detail&&(b.cache.detail.teamID=null===a||void 0===a?void 0:a.id);session.setTeam(a);break;case command.server.sprintUpdate:b.cache.detail&&
(b.cache.detail.sprintID=null===a||void 0===a?void 0:a.id);session.setSprint(a);break;case command.server.feedbackUpdate:feedback.onFeedbackUpdate(a);break;case command.server.feedbackRemove:feedback.onFeedbackRemoved(a);break;default:console.warn("unhandled command ["+c+"] for retro")}};b.onSubmitRetroSession=function(){var c=dom.req("#model-title-input").value,a=dom.req("#model-categories-input").value,d=dom.req("#model-team-select select").value,f=dom.req("#model-sprint-select select").value,g=
permission.readPermissions();socket.send({svc:services.retro.key,cmd:command.client.updateSession,param:{title:c,categories:a,teamID:d,sprintID:f,permissions:g}})}})(retro||(retro={}));var session;
(function(b){b.setDetail=function(e){var c,a=(null===(c=system.cache.session)||void 0===c?void 0:c.slug)||"invalid";system.cache.session=e;document.title=e.title;dom.setText("#model-title",e.title);dom.setText("#session-view-section .uk-modal-title",e.title);dom.setValue("#model-title-input",e.title);c=dom.els("#navbar .uk-navbar-item");0<c.length&&dom.setText(c[c.length-1],e.title);a!==e.slug&&window.history.replaceState(null,"",document.location.href.replace(a,e.slug));member.selfCanEdit()&&modal.hide("session")};
b.onSessionJoin=function(e){system.cache.apply(e);permission.setPerms();member.setMembers();comment.setCounts()};b.showWelcomeMessage=function(e){1===e&&setTimeout(function(){return modal.open("welcome")},300)};b.setTeam=function(e){var c=dom.req("#team-link-container"),a=dom.req("#session-view-section .team");dom.clear(c);dom.setDisplay("#team-warning-container",void 0!==e);e?(c.appendChild(team.renderTeamLink(e)),dom.setContent(a,team.renderTeamLink(e,!0)),dom.setText("#team-warning-name",e.title)):
dom.setHTML(a,"-none-")};b.setSprint=function(e){var c=dom.req("#sprint-link-container"),a=dom.req("#session-view-section .sprint");dom.clear(c);dom.setDisplay("#sprint-warning-container",void 0!==e);e?(c.appendChild(sprint.renderSprintLink(e)),dom.setContent(a,sprint.renderSprintLink(e,!0)),dom.setText("#sprint-warning-name",e.title)):dom.setHTML(a,"-none-")};b.onModalOpen=function(e){var c=dom.setValue("#model-title-input",dom.req("#model-title").innerText);setTimeout(function(){return c.focus()},
250);team.refreshTeams();sprint.refreshSprints()}})(session||(session={}));var socket;
(function(b){function e(){var h=document.location,l="ws";"https:"===h.protocol&&(l="wss");return l+("://"+h.host+"/s")}function c(h,l){system.cache.currentService=h;system.cache.currentID=l;system.cache.connectTime=Date.now();g=new WebSocket(e());g.onopen=function(){a({svc:h.key,cmd:command.client.connect,param:l})};g.onmessage=function(m){m=JSON.parse(m.data);d(m)};g.onerror=function(m){};g.onclose=function(){f()}}function a(h){debug&&console.debug("out",h);g.send(JSON.stringify(h))}function d(h){debug&&
console.debug("in",h);switch(h.svc){case services.system.key:system.onSystemMessage(h.cmd,h.param);break;case services.team.key:team.onTeamMessage(h.cmd,h.param);break;case services.sprint.key:sprint.onSprintMessage(h.cmd,h.param);break;case services.estimate.key:estimate.onEstimateMessage(h.cmd,h.param);break;case services.standup.key:standup.onStandupMessage(h.cmd,h.param);break;case services.retro.key:retro.onRetroMessage(h.cmd,h.param);break;default:console.warn("unhandled message for service ["+
h.svc+"]")}}function f(){function h(l){debug&&console.info("socket closed, reconnecting in "+l+" seconds");setTimeout(function(){c(system.cache.currentService,system.cache.currentID)},1E3*l)}k||h(10)}var g,k=!1;b.setAppUnloading=function(){k=!0};b.socketConnect=c;b.send=a;b.onSocketMessage=d})(socket||(socket={}));var sprint;
(function(b){function e(c){b.cache.detail=c;var a=c.startDate?date.utcDate(c.startDate):void 0,d=c.endDate?date.utcDate(c.endDate):void 0;dom.setContent("#sprint-date-display",b.renderSprintDates(a,d));dom.setValue("#sprint-start-date-input",a?date.dateToYMD(a):"");dom.setValue("#sprint-end-date-input",d?date.dateToYMD(d):"");session.setDetail(c)}b.cache=new function(){};b.onSprintMessage=function(c,a){switch(c){case command.server.error:rituals.onError(services.sprint,a);break;case command.server.sessionJoined:session.onSessionJoin(a);
e(a.session);dom.setContent("#sprint-estimate-list",contents.renderContents(services.sprint,services.estimate,a.estimates));dom.setContent("#sprint-standup-list",contents.renderContents(services.sprint,services.standup,a.standups));dom.setContent("#sprint-retro-list",contents.renderContents(services.sprint,services.retro,a.retros));session.showWelcomeMessage(a.members.length);break;case command.server.teamUpdate:b.cache.detail&&(b.cache.detail.teamID=null===a||void 0===a?void 0:a.id);session.setTeam(a);
break;case command.server.sessionUpdate:e(a);break;case command.server.sessionRemove:system.onSessionRemove(services.sprint);break;case command.server.permissionsUpdate:system.setPermissions(a);break;case command.server.contentUpdate:socket.socketConnect(system.cache.currentService,system.cache.currentID);break;default:console.warn("unhandled command ["+c+"] for sprint")}};b.onSubmitSprintSession=function(){var c,a,d=dom.req("#model-title-input").value,f=dom.req("#model-team-select select").value,
g=null===(c=dom.opt("#sprint-start-date-input"))||void 0===c?void 0:c.value;c=null===(a=dom.opt("#sprint-end-date-input"))||void 0===a?void 0:a.value;a=permission.readPermissions();socket.send({svc:services.sprint.key,cmd:command.client.updateSession,param:{title:d,startDate:g,endDate:c,teamID:f,permissions:a}})};b.refreshSprints=function(){dom.opt("#model-sprint-select")&&socket.send({svc:services.system.key,cmd:command.client.getSprints,param:null})};b.viewSprints=function(c){var a;dom.opt("#model-sprint-container")&&
(dom.setContent("#model-sprint-select",b.renderSprintSelect(c,null===(a=system.cache.session)||void 0===a?void 0:a.sprintID)),permission.setModelPerms("sprint"))}})(sprint||(sprint={}));
(function(b){b.renderSprintDates=function(e,c){function a(g,k){return JSX("span",null,g," ",JSX("span",{class:"sprint-date",onclick:"modal.open('session');"},k?date.toDateString(k):""))}var d=a("starts",e),f=a("ends",c);return e?c?JSX("span",null,d,", ",f):d:c?f:JSX("span",null,"Sprint")};b.renderSprintLink=function(e,c){var a=system.cache.getProfile();e=JSX("a",{class:a.linkColor+"-fg",href:"/sprint/"+e.slug},e.title);return c?e:JSX("span",null,e," ")};b.renderSprintSelect=function(e,c){return JSX("select",
{class:"uk-select",onchange:"permission.setModelPerms('sprint')"},JSX("option",{value:""},"- no sprint -"),e.map(function(a){return a.id===c?JSX("option",{selected:"selected",value:a.id},a.title):JSX("option",{value:a.id},a.title)}))}})(sprint||(sprint={}));var standup;
(function(b){function e(a){return b.cache.reports.filter(function(d){return d.id!==a})}function c(a,d){report.setReports(a);d===b.cache.activeReport&&modal.hide("report")}b.cache=new function(){this.reports=[]};b.onStandupMessage=function(a,d){switch(a){case command.server.error:rituals.onError(services.standup,d);break;case command.server.sessionJoined:session.onSessionJoin(d);a=d.session;b.cache.detail=a;session.setDetail(a);report.setReports(d.reports);session.showWelcomeMessage(d.members.length);
break;case command.server.sessionUpdate:b.cache.detail=d;session.setDetail(d);break;case command.server.sessionRemove:system.onSessionRemove(services.standup);break;case command.server.permissionsUpdate:system.setPermissions(d);break;case command.server.teamUpdate:b.cache.detail&&(b.cache.detail.teamID=null===d||void 0===d?void 0:d.id);session.setTeam(d);break;case command.server.sprintUpdate:b.cache.detail&&(b.cache.detail.sprintID=null===d||void 0===d?void 0:d.id);session.setSprint(d);break;case command.server.reportUpdate:a=
e(d.id);a.push(d);c(a,d.id);break;case command.server.reportRemove:a=e(d);c(a,d);notify.notify("report has been deleted",!0);break;default:console.warn("unhandled command ["+a+"] for standup")}};b.onSubmitStandupSession=function(){var a=dom.req("#model-title-input").value,d=dom.req("#model-team-select select").value,f=dom.req("#model-sprint-select select").value,g=permission.readPermissions();socket.send({svc:services.standup.key,cmd:command.client.updateSession,param:{title:a,teamID:d,sprintID:f,
permissions:g}})}})(standup||(standup={}));var story;
(function(b){function e(a){function d(g,k){g.id.substr(g.id.lastIndexOf("-")+1)===k?g.classList.add("active"):g.classList.remove("active")}dom.els(".story-status-body").forEach(function(g){d(g,a)});dom.els(".story-status-actions").forEach(function(g){d(g,a)});var f="";switch(a){case "pending":f="Story";break;case "active":f="Voting";break;case "complete":f="Results"}dom.setText("#story-status",f);vote.viewVotes()}function c(a,d,f,g){f&&"complete"===f.status&&0<f.finalVote.length&&(d=f.finalVote);
dom.setContent("#story-"+a+" .story-status",b.renderStatus(d));g&&b.showTotalIfNeeded()}b.viewStoryStatus=e;b.requestStoryStatus=function(a){var d=b.getActiveStory();d&&socket.send({svc:services.estimate.key,cmd:command.client.setStoryStatus,param:{storyID:d.id,status:a}})};b.setStoryStatus=c;b.onStoryStatusChange=function(a){var d=void 0;estimate.cache.stories.forEach(function(f){f.id===a.storyID&&(d=f,f.finalVote=a.finalVote,f.status=a.status)});c(a.storyID,a.status,d,!0);a.storyID===estimate.cache.activeStory&&
e(a.status)}})(story||(story={}));
(function(b){function e(){if(estimate.cache.activeStory){var a=estimate.cache.stories.filter(function(d){return d.id===estimate.cache.activeStory}).shift();a||console.warn("cannot load active story ["+estimate.cache.activeStory+"]");return a}}function c(){var a=0;estimate.cache.stories.filter(function(g){return"complete"===g.status}).map(function(g){return g.finalVote}).filter(function(g){return 0<g.length}).map(function(g){return parseFloat(g)}).filter(function(g){return!isNaN(g)}).forEach(function(g){return a+=g});
var d=dom.opt("#story-total"),f=dom.req("#story-list");void 0!==d&&f.removeChild(d);0<a&&f.appendChild(b.renderTotal(a))}b.setStories=function(a){estimate.cache.stories=a;dom.setContent("#story-detail",b.renderStories(a));a.forEach(function(d){return b.setStoryStatus(d.id,d.status,d,!1)});c();comment.setCounts();modal.hide("add-story")};b.onSubmitStory=function(){var a=dom.req("#story-title-input").value;socket.send({svc:services.estimate.key,cmd:command.client.addStory,param:{title:a}});return!1};
b.beginEditStory=function(){var a=e(),d=prompt("Edit your story",a.title);if(null===d)return!1;d&&d!==a.title&&socket.send({svc:services.estimate.key,cmd:command.client.updateStory,param:{storyID:a.id,title:d}});return!1};b.onRemoveStory=function(){var a=estimate.cache.activeStory;a&&notify.confirm("Delete this story?",function(){socket.send({svc:services.estimate.key,cmd:command.client.removeStory,param:a});modal.hide("story")});return!1};b.getActiveStory=e;b.viewActiveStory=function(a){a&&(estimate.cache.activeStory=
a);if(a=e())dom.setText("#story-title",a.title),b.viewStoryStatus(a.status),comment.setActive("story",a.id),comment.setCounts()};b.showTotalIfNeeded=c})(story||(story={}));
(function(b){b.renderStories=function(e){return 0===e.length?JSX("div",{id:"story-list"},JSX("button",{class:"uk-button uk-button-default",onclick:"modal.open('add-story');",type:"button"},"Add Story")):JSX("table",{class:"uk-table uk-table-divider uk-table-small"},JSX("ul",{id:"story-list",class:"uk-list uk-list-divider"},e.map(function(c){var a=system.cache.getProfile();return JSX("li",{id:"story-"+c.id,class:"section",onclick:"modal.open('story', '"+c.id+"');"},JSX("div",{class:"right uk-article-meta story-status"},
c.status),JSX("div",{class:a.linkColor+"-fg section-link left"},c.title),JSX("div",{class:"left",style:"margin-top: 4px;"},comment.renderCount("story",c.id)))})))};b.renderStatus=function(e){switch(e){case "pending":return JSX("span",null,e);case "active":return JSX("span",null,e);default:return JSX("span",{class:"vote-badge"},e)}};b.renderTotal=function(e){return JSX("li",{id:"story-total"},JSX("div",{class:"right uk-article-meta"},JSX("span",{class:"vote-badge"},e))," ","Total")};b.viewAddStory=
function(){var e=dom.setValue("#story-title-input","");setTimeout(function(){return e.focus()},250)}})(story||(story={}));var debug=!0,system;
(function(b){var e=function(){this.currentID="";this.connectTime=0};e.prototype.getProfile=function(){if(!this.profile)throw"no active profile";return this.profile};e.prototype.apply=function(c){b.cache.session=c.session;b.cache.profile=c.profile;auth.applyAuths(c.auths);permission.applyPermissions(c.permissions);member.applyMembers(c.members);member.applyOnline(c.online);comment.applyComments(c.comments);void 0!==c.team&&session.setTeam(c.team);void 0!==c.sprint&&session.setSprint(c.sprint)};b.cache=
new e;b.setPermissions=function(c){permission.applyPermissions(c);permission.setPerms()};b.setAuths=function(c){auth.applyAuths(c);permission.setPerms()};b.onSystemMessage=function(c,a){switch(c){case command.server.error:rituals.onError(services.system,a);break;case command.server.actions:action.viewActions(a);break;case command.server.teams:team.viewTeams(a);break;case command.server.sprints:sprint.viewSprints(a);break;case command.server.memberUpdate:member.onMemberUpdate(a);break;case command.server.memberRemove:member.onMemberRemove(a);
break;case command.server.onlineUpdate:member.onOnlineUpdate(a);break;case command.server.commentUpdate:comment.onCommentUpdate(a);break;case command.server.commentRemove:comment.onCommentRemoved(a);break;default:console.warn("unhandled system message for command ["+c+"]")}};b.onSessionRemove=function(c){document.location.reload()}})(system||(system={}));var team;
(function(b){b.cache=new function(){};b.onTeamMessage=function(e,c){switch(e){case command.server.error:rituals.onError(services.team,c);break;case command.server.sessionJoined:session.onSessionJoin(c);e=c.session;b.cache.detail=e;session.setDetail(e);dom.setContent("#team-sprint-list",contents.renderContents(services.team,services.sprint,c.sprints));dom.setContent("#team-estimate-list",contents.renderContents(services.team,services.estimate,c.estimates));dom.setContent("#team-standup-list",contents.renderContents(services.team,
services.standup,c.standups));dom.setContent("#team-retro-list",contents.renderContents(services.team,services.retro,c.retros));session.showWelcomeMessage(c.members.length);break;case command.server.sessionUpdate:b.cache.detail=c;session.setDetail(c);break;case command.server.sessionRemove:system.onSessionRemove(services.team);break;case command.server.permissionsUpdate:system.setPermissions(c);break;case command.server.contentUpdate:socket.socketConnect(system.cache.currentService,system.cache.currentID);
break;default:console.warn("unhandled command ["+e+"] for team")}};b.onSubmitTeamSession=function(){var e=dom.req("#model-title-input").value,c=permission.readPermissions();socket.send({svc:services.team.key,cmd:command.client.updateSession,param:{title:e,permissions:c}})};b.refreshTeams=function(){dom.opt("#model-team-select")&&socket.send({svc:services.system.key,cmd:command.client.getTeams,param:null})};b.viewTeams=function(e){var c;dom.opt("#model-team-container")&&(dom.setContent("#model-team-select",
b.renderTeamSelect(e,null===(c=system.cache.session)||void 0===c?void 0:c.teamID)),permission.setModelPerms("team"))}})(team||(team={}));
(function(b){b.renderTeamLink=function(e,c){var a=system.cache.getProfile();e=JSX("a",{class:a.linkColor+"-fg",href:"/team/"+e.slug},e.title);return c?e:JSX("span",null,"in ",e)};b.renderTeamSelect=function(e,c){return JSX("select",{class:"uk-select",onchange:"permission.setModelPerms('team')"},JSX("option",{value:""},"- no team -"),e.map(function(a){return a.id===c?JSX("option",{selected:"selected",value:a.id},a.title):JSX("option",{value:a.id},a.title)}))}})(team||(team={}));var profile;
(function(b){b.setNavColor=function(e,c){dom.setValue("#nav-color",c);dom.req("#navbar").className=c+"-bg uk-navbar-container uk-navbar";document.querySelectorAll(".nav_swatch").forEach(function(a){a.classList.remove("active")});e.classList.add("active")};b.setLinkColor=function(e,c){dom.setValue("#link-color",c);dom.els(".profile-link").forEach(function(a){a.classList.forEach(function(d){-1<d.indexOf("-fg")&&a.classList.remove(d);a.classList.add(c+"-fg")})});document.querySelectorAll(".link_swatch").forEach(function(a){a.classList.remove("active")});
e.classList.add("active")};b.setPicture=function(e){dom.setValue("#self-picture-input",e);return!1}})(profile||(profile={}));var collection;
(function(b){var e=function(a){this.members=[];this.key=a};b.Group=e;var c=function(){this.groups=[]};c.prototype.findOrInsert=function(a){var d=this.groups.find(function(f){return f.key===a});if(d)return d;d=new e(a);this.groups.push(d);return d};b.GroupSet=c;b.groupBy=function(a,d){var f=new c;a&&a.forEach(function(g){f.findOrInsert(d(g)).members.push(g)});return f};b.findGroup=function(a,d){a=$jscomp.makeIterator(a);for(var f=a.next();!f.done;f=a.next())if(f=f.value,f.key===d)return f.members;
return[]};b.flatten=function(a){var d=[];a.forEach(function(f){return d.push.apply(d,$jscomp.arrayFromIterable(f))});return d}})(collection||(collection={}));var date;
(function(b){function e(d){return d.toLocaleDateString()}function c(d){return d.toLocaleTimeString().slice(0,8)}b.dateToYMD=function(d){var f=d.getDate(),g=d.getMonth()+1;return d.getFullYear()+"-"+(9>=g?"0"+g:g)+"-"+(9>=f?"0"+f:f)};b.dateFromYMD=function(d){d=new Date(d);return new Date(d.getTime()+6E4*d.getTimezoneOffset())};b.dow=function(d){switch(d){case 0:return"Sun";case 1:return"Mon";case 2:return"Tue";case 3:return"Wed";case 4:return"Thu";case 5:return"Fri";case 6:return"Sat";default:return"???"}};
b.toDateString=e;b.toTimeString=c;b.toDateTimeString=function(d){return e(d)+" "+c(d)};var a=6E4*(new Date).getTimezoneOffset();b.utcDate=function(d){return new Date(Date.parse(d)+a)}})(date||(date={}));var notify;(function(b){b.notify=function(e,c){UIkit.notification(e,{status:c?"success":"danger",pos:"top-right"})};b.confirm=function(e,c){UIkit.modal.confirm(e).then(c)};b.modal=function(e){var c=UIkit.modal(e);c||console.warn("no modal available with key ["+e+"]");return c}})(notify||(notify={}));
var vote;
(function(b){function e(){var c=story.getActiveStory();if(c){var a=estimate.cache.activeVotes(),d=a.filter(function(f){return f.userID===system.cache.getProfile().userID}).pop();switch(c.status){case "pending":c=system.cache.getProfile().userID===c.userID;dom.setDisplay("#story-edit-section",c);dom.setDisplay("#story-view-section",!c);break;case "active":dom.setContent("#story-vote-members",b.renderVoteMembers(member.getMembers(),a));dom.setContent("#story-vote-choices",b.renderVoteChoices(estimate.cache.detail.choices,null===
d||void 0===d?void 0:d.choice));break;case "complete":dom.setContent("#story-vote-results",b.renderVoteResults(member.getMembers(),a));dom.setContent("#story-vote-summary",b.renderVoteSummary(a));break;default:console.warn("invalid story status ["+c.status+"]")}}}b.setVotes=function(c){estimate.cache.votes=c;e()};b.onVoteUpdate=function(c){var a=estimate.cache.votes;a=a.filter(function(d){return d.userID!==c.userID||d.storyID!==c.storyID});a.push(c);estimate.cache.votes=a;c.storyID===estimate.cache.activeStory&&
e()};b.viewVotes=e;b.onSubmitVote=function(c){socket.send({svc:services.estimate.key,cmd:command.client.submitVote,param:{storyID:estimate.cache.activeStory,choice:c}})};b.getVoteResults=function(c){c=c.map(function(h){h=parseFloat(h.choice);return isNaN(h)?-1:h}).filter(function(h){return-1!==h}).sort();var a=c.length,d=Math.min.apply(Math,$jscomp.arrayFromIterable(c)),f=Math.max.apply(Math,$jscomp.arrayFromIterable(c)),g=c.reduce(function(h,l){return h+l},0),k=c.reduce(function(h,l){var m=h.numMapping[l]=
(h.numMapping[l]||0)+1;m>h.greatestFreq&&(h.greatestFreq=m,h.mode=l);return h},{mode:null,greatestFreq:-Infinity,numMapping:{}}).mode;return{count:a,min:d,max:f,sum:g,mean:0===a?0:g/a,median:0===a?0:c[Math.floor(c.length/2)],mode:0===a?0:k}}})(vote||(vote={}));
(function(b){function e(a,d){return JSX("div",{class:"vote-member",title:a.name+" has "+(d?"voted":"not voted")},JSX("div",null,JSX("span",{"data-uk-icon":"icon: "+(d?"check":"minus")+"; ratio: 1.6"})),a.name)}function c(a,d){return d?JSX("div",{class:"vote-result"},JSX("div",null,JSX("span",{class:"uk-border-circle"},d))," ",a.name):JSX("div",{class:"vote-result"},JSX("div",null,JSX("span",{class:"uk-border-circle"},JSX("span",{"data-uk-icon":"icon: minus; ratio: 1.6"})))," ",a.name)}b.renderVoteMembers=
function(a,d){return JSX("div",{class:"uk-flex uk-flex-wrap uk-flex-around"},a.map(function(f){return e(f,0<d.filter(function(g){return g.userID===f.userID}).length)}))};b.renderVoteChoices=function(a,d){return JSX("div",{class:"uk-flex uk-flex-wrap uk-flex-center"},a.map(function(f){return JSX("div",{class:"vote-choice uk-border-circle uk-box-shadow-hover-medium"+(f===d?" active "+system.cache.getProfile().linkColor+"-border":""),onclick:"vote.onSubmitVote('"+f+"');"},f)}))};b.renderVoteResults=
function(a,d){return JSX("div",{class:"uk-flex uk-flex-wrap uk-flex-around"},a.map(function(f){var g=d.filter(function(k){return k.userID===f.userID});return c(f,0<g.length?g[0].choice:void 0)}))};b.renderVoteSummary=function(a){function d(g){return g.toString().substr(0,4)}var f=b.getVoteResults(a);return JSX("div",{class:"uk-flex uk-flex-wrap uk-flex-center result-container"},JSX("div",{class:"result"},JSX("div",{class:"secondary uk-border-circle"},d(f.count)," / ",d(a.length))," ",JSX("div",null,
"votes counted")),JSX("div",{class:"result"},JSX("div",{class:"secondary uk-border-circle"},d(f.min),"-",d(f.max))," ",JSX("div",null,"vote range")),JSX("div",{class:"result mean-result"},JSX("div",{class:"mean uk-border-circle "+system.cache.getProfile().linkColor+"-border"},d(f.mean))," ",JSX("div",null,"average")),JSX("div",{class:"result"},JSX("div",{class:"secondary uk-border-circle"},d(f.median))," ",JSX("div",null,"median")),JSX("div",{class:"result"},JSX("div",{class:"secondary uk-border-circle"},
d(f.mode))," ",JSX("div",null,"mode")))}})(vote||(vote={}));
