<%: func ComponentSessionPerm(svc util.Service, showTeam bool, showSprint bool, auths auth.Records, ctx *npnweb.RequestContext, buffer *bytes.Buffer) %>
<div class="uk-margin">
  <label class="uk-form-label" for="model-perm-form">Permissions</label>
  <div id="model-perm-form">
    <ul class="uk-list">
      <% if !(showTeam || showSprint || len(auths) > 0){ %>
        <li>
          Control access to this <%= svc.Key %> by
          <a class="theme" href="<%= ctx.Route(npncore.KeyProfile) %>">signing in</a>
        </li>
      <% } %>
      <% if showTeam { %>
        <li id="perm-team-section">
          <label>
            <input id="perm-team-checkbox" name="perm-team" class="uk-checkbox uk-margin-small-right" type="checkbox" value="true" />Must be a member of this <%= svc.Key %>'s <%= util.SvcTeam.Key %>
          </label>
        </li>
      <% } %>
      <% if showSprint { %>
        <li id="perm-sprint-section">
          <label>
            <input id="perm-sprint-checkbox" name="perm-sprint" class="uk-checkbox uk-margin-small-right" type="checkbox" value="true" />Must be a member of this <%= svc.Key %>'s <%= util.SvcSprint.Key %>
          </label>
        </li>
      <% } %>
      <% if ctx.App.Auth().Enabled() { %>
        <% for _, p := range ctx.App.Auth().EnabledProviders() { %>
          <%
            pcls := "uk-checkbox uk-margin-small-right"
            poc := "permission.onChanged('provider', '" +  p.Key + "', this.checked)"
            cls := "uk-checkbox uk-margin-small-right perm-" + p.Key + "-email"
            oc := "permission.onChanged('email', '" + p.Key + "', this.checked)"
            a := auths.FindByProvider(p.Key)

            style := "display: none;"
            if len(a) > 0 {
              style = "display: block;"
            }
          %>
          <li id="perm-<%= p.Key %>-section" style="<%= style %>">
            <label>
              <input id="perm-<%= p.Key %>-checkbox" name="perm-<%= p.Key %>" class="<%= pcls %>" onchange="<%= poc %>" type="checkbox" value="true" />Must sign in with <%= p.Title %>
            </label>
            <div id="perm-<%= p.Key %>-email-container">
              <ul>
                <% for _, e := range a.Emails() { %>
                  <% domain := npncore.GetDomain(e) %>
                  <li>
                    <label>
                      <input class="<%= cls %>" type="checkbox" name="perm-<%= p.Key %>-email" value="<%= domain %>" onchange="<%= oc %>" />
                      Using email address <%= domain %>
                    </label>
                  </li>
                <% } %>
              </ul>
            </div>
          </li>
        <% } %>
      <% } %>
    </ul>
  </div>
</div>
